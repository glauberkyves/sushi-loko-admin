{% extends 'SuperBaseBundle::layout.html.twig' %}
{% block body %}
    <section class="panel">
        <header class="panel-heading">
            Busca inteligente
        </header>
        <div class="panel-body">
            <form action=" " class="form-horizontal tasi-form" id="form-pesquisa" method="get">

                <div class="form-group">
                    <label class="col-sm-2 control-label col-lg-2" for="inputSuccess">Sexo</label>

                    <div class="col-lg-2">
                        {{ formSelect("sgSexo", entity.getSgSexo(), {'class': 'form-control valid'}, cmbSexo) }}
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Idade mínima</label>

                    <div class="col-lg-2">
                        <input type="text" name="nuIdadeMin" mask="99" class="form-control"
                               value="{{ entity.getNuIdadeMin() }}"
                               placeholder="Idade mínima">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Idade máxima</label>

                    <div class="col-lg-2">
                        <input type="text" name="nuIdadeMax" mask="99" class="form-control" id=""
                               placeholder="Idade máxima">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Atividade</label>

                    <div class="col-lg-2">
                        <select name="nuAtividade" class="form-control">
                            <option value="1">Que foi</option>
                            <option value="2">Que não foi</option>
                            <option value="0">Todos</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Lista de franqueados</label>

                    <div class="col-lg-4">
                        {{ formSelect('', {}, {'class': 'multi-select', 'multiple': 'multiple', 'id': 'idFranqueado', 'name': 'idFranqueado[]', 'required': 'required'}, cmbFranquia) }}
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Nos últimos</label>

                    <div class="col-lg-2">
                        <input name="nuPeriodo" type="text" mask="99999" class="form-control">
                    </div>
                    <div class="col-lg-2">
                        {{ formSelect("noPeriodo", null, {'class': 'form-control valid'}, cmbPeriodo) }}
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Que obtiveram créditos nos últimos</label>

                    <div class="col-lg-2">
                        <input name="nuCreditoPeriodo" type="text" mask="99999" class="form-control" id="">
                    </div>
                    <div class="col-lg-2">
                        {{ formSelect("noCreditoPeriodo", null, {'class': 'form-control valid'}, cmbPeriodo) }}
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Que utilizaram créditos nos últimos</label>

                    <div class="col-lg-2">
                        <input name="nuDebitoPeriodo" type="text" mask="99999" class="form-control" id="">
                    </div>
                    <div class="col-lg-2">
                        {{ formSelect("noDebitoPeriodo", null, {'class': 'form-control valid'}, cmbPeriodo) }}
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Que obtiveram e utilizaram créditos nos
                        últimos</label>

                    <div class="col-lg-2">
                        <input name="nuBonusTransacionado" type="text" mask="99999" class="form-control" id="">
                    </div>
                    <div class="col-lg-2">
                        {{ formSelect("noBonusTransacionado", null, {'class': 'form-control valid'}, cmbPeriodo) }}
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Que possuam saldo de crédito</label>

                    <div class="col-lg-2">
                        {{ formSelect("noSaldoBonus", null, {'class': 'form-control valid'}, cmbOperador) }}
                    </div>
                    <div class="col-lg-2">
                        <div class="input-group m-bot15">
                            <span class="input-group-addon">R$</span>
                            <input name="nuSaldoBonus" type="text" mask="decimal" class="form-control">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Período</label>

                    <div class="col-lg-2">
                        <div class="input-group m-bot15">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            {{ formText("dtInicio", null, {'class': 'form-control valid', 'data-mask': '99/99/9999'}) }}
                        </div>
                    </div>
                    <div class="col-lg-2">
                        <div class="input-group m-bot15">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            {{ formText("dtFim", null, {'class': 'form-control valid', 'data-mask': '99/99/9999'}) }}
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Que se registraram a</label>

                    <div class="col-lg-2">
                        <input name="nuCadastro" type="text" mask="99999" class="form-control" id="">
                    </div>
                    <div class="col-lg-2">
                        {{ formSelect("noCadastro", null, {'class': 'form-control valid'}, cmbPeriodo) }}
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Que possuam média de consumo</label>

                    <div class="col-lg-2">
                        {{ formSelect("noMediaConsumo", null, {'class': 'form-control valid'}, cmbOperador) }}
                    </div>
                    <div class="col-lg-2">
                        <div class="input-group m-bot15">
                            <span class="input-group-addon">R$</span>
                            <input name="nuMediaConsumo" type="text" mask="decimal" class="form-control">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Que já consumiu até hoje</label>

                    <div class="col-lg-4">
                        <div class="input-group m-bot15">
                            <span class="input-group-addon">R$</span>
                            <input name="nuConsumoTotal" type="text" mask="decimal" class="form-control">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Aniversariantes do mês</label>

                    <div class="col-lg-10">
                        <label class="checkbox-inline">
                            <input name="nuAniversariante" type="checkbox" id="inlineCheckbox1" value="1">
                        </label>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-search"></i>
                    Buscar
                </button>
            </form>
        </div>
    </section>
    <section class="panel" id="filtro-resultado">
        <header class="panel-heading">
            Filtro do resultado
            <a href="javascript:;" class="btn btn-warning btn-xs export" style="float:right">
                <i class="fa fa-download"></i>
                Exportar em CSV
            </a>

            <a href="javascript:;" class="btn btn-warning btn-xs exportExcel" style="float:right; margin-right: 5px;">
                <i class="fa fa-file-text"></i>
                Exportar em Excel
            </a>
        </header>
        <div class="panel-body">
            <form id="form-filtro" class="form-horizontal tasi-form m-bot15" method="get">
                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Acrescentar pontos</label>

                    <div class="col-lg-2">
                        <input name="addPontos" type="number" class="form-control" id="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label">Acrescentar créditos</label>

                    <div class="col-lg-2">
                        <div class="input-group m-bot15">
                            <span class="input-group-addon">R$</span>
                            <input name="addBonus" type="text" mask="decimal" class="form-control">
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-usd"></i>
                    Acrescentar
                </button>
                <label id="loading" class="hidden control-label"><b>Aguarde..</b></label>
            </form>
            <section id="unseen">
                <table class="table table-bordered table-striped table-condensed" data-grid="form-pesquisa">
                    <thead>
                    <tr>
                        <th data-column="noPessoa">Nome</th>
                        <th data-column="nuBonus">Crédito</th>
                        <th data-column="sgSexo">Sexo</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="odd">
                        <td valign="top" colspan="5">Acione a pesquisa</td>
                    </tr>
                    </tbody>
                </table>
            </section>
        </div>
    </section>
    <script>
        $(function () {
            $('#idFranqueado').multiSelect();
            $('.export').click(function () {
                window.location = "{{ path('super_franqueador_pesquisa') }}" + "?exportar=csv&";
            });
            $('.exportExcel').click(function () {
                window.location = "{{ path('super_franqueador_pesquisa') }}" + "?exportar=excel&";
            });
            $('#form-pesquisa').submit(function (e) {
                if ($(this).valid()) {
                    $('html, body').animate({
                        scrollTop: $("#filtro-resultado").offset().top
                    }, 1500);
                }
            });
            $('#form-filtro').submit(function (e) {
                e.preventDefault();
                var self = $(this);
                var button = self.find("button");
                var loading = $("#loading");
                button.hide();
                loading.removeClass("hidden");
                $.get("{{ path('super_franqueador_pesquisa') }}",
                        $('#form-filtro').serialize(),
                        function (data) {
                            if (data.valido == true) {
                                toastr["success"](data.mensagem);
                                $('#form-pesquisa').submit();
                            } else {
                                toastr["error"](data.mensagem);
                            }
                            loading.addClass("hidden");
                            button.show();
                        }
                );
            });
        });
    </script>
{% endblock %}